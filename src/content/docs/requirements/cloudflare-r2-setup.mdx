---
title: Cloudflare R2 Setup
---
import { Steps, Aside } from "@astrojs/starlight/components";

<Aside>
As of v0.1.0-alpha.2, only Cloudflare R2 is officially supported. We will support other S3 compatible storage options such as AWS S3, Digital Ocean Space, MinIO, and other object storage in the future.
</Aside>

Isekai Core uses Cloudflare R2 for storing files. R2 is S3-compatible, fast, and has zero egress fees, making it perfect for object storage. For personal use, free tier gives you enough to start.

To create a bucket and get the credentials, follow this step-by-step guide:

<Steps>

1. **Create a Bucket**

   - Log in to the Cloudflare Dashboard.
   - Go to **R2** in the sidebar.
   - Click **Create Bucket**.
   - Name it (e.g., `isekai-uploads`).
   - Click **Create Bucket**.

2. **Configure CORS**

   By default, browsers block web apps from uploading files directly to a different domain. You must explicitly allow your frontend domain to upload to your bucket.

   - In your bucket view, go to **Settings**.
   - Scroll down to **CORS Policy**.
   - Click **Edit CORS Policy** and paste the following JSON:

   ```json
   [
     {
       "AllowedOrigins": [
         "https://isekai.yourdomain.com",
         "http://localhost:3000"
       ],
       "AllowedMethods": [
         "PUT",
         "GET",
         "HEAD"
       ],
       "AllowedHeaders": [
         "*"
       ],
       "ExposeHeaders": [
         "ETag"
       ],
       "MaxAgeSeconds": 3000
     }
   ]
   ```

   - Replace `https://isekai.yourdomain.com` with your actual frontend URL.

3. **Public Access**

   - In your bucket **Settings**, scroll to **Public Access**.
   - **R2.dev Subdomain**: You can enable this for a quick start (e.g., `https://pub-xyz.r2.dev`).
   - **Custom Domain (Recommended)**: Connect a domain like `files.yourdomain.com` for better branding.
   - Copy this URL. This becomes your `R2_PUBLIC_URL`.

4. **API Credentials**

   - Go back to the main **R2 Overview** page (not inside the bucket).
   - Click **Manage R2 API Tokens** (on the right sidebar).
   - Click **Create API Token**.
   - **Permissions**: Select **Admin Read & Write**.
   - **TTL**: Forever.
   - Click **Create API Token**.
   - Copy these values to your `.env` file:
     - **Access Key ID** → `R2_ACCESS_KEY_ID`
     - **Secret Access Key** → `R2_SECRET_ACCESS_KEY`
     - **Account ID** (found in the URL or dashboard sidebar) → `R2_ACCOUNT_ID`

</Steps>